# 存储结构

一张表的完成物理结构分为3个层级：数据表目录、分区目录及各分区下具体的数据文件。

* `partition`：分区目录，各类数据文件(`primary.idx`、`[Column].mrk`、`[Column].bin`等)都是以分区目录的形式被组织存放的，属于相同分区的数据，最终会被合并到同一个分区目录，而不同分区数据，永远不会被合并在一起。

* `checksums.txt`：校验文件，使用二进制格式存储。保存了各类文件(`primary.idx`、`count.txt`)的size大小及size的哈希值，用于快速校验文件的完整性和正确性。

* `columns.txt`：列信息文件，用于保存此数据分区下的列字段信息。

* `count.txt`：计数文件，用于记录当前数据分区目录下数据的总行数。

* `primary.idx`：一级索引文件，使用二进制格式存储。存放稀疏索引，一张MergeTree表只能声明一次一级索引。

* `[Column].bin`：数据文件，压缩格式存储，使用`LZ4`压缩格式，用于存储某一列数据，MergeTree采用列式存储，每一列字段都拥有独立的`.bin`数据文件，并以列字段名称命名。

* `[Column].mrk`：列字段标记文件，使用二进制格式存储。保存了 `.bin` 文件中数据的偏移量信息。该文件与`primary.idx` 文件对齐，与 `.bin` 文件相对应。MergeTree通过该标记文件建立起索引文件和数据文件之间的映射关系。
